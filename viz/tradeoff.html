<!DOCTYPE html>
<html>
<head>
  <style>
    .error {
        color: red;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-lite@4.0.2"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300, "strokeOpacity": 0}, "axis": {"labelFontSize": 14, "titleFontSize": 14}, "title": {"fontSize": 16}}, "layer": [{"mark": {"type": "circle", "size": 100}, "encoding": {"color": {"type": "ordinal", "field": "n", "legend": null, "scale": {"scheme": "viridis"}}, "tooltip": [{"type": "quantitative", "field": "n", "title": "Top n%"}, {"type": "quantitative", "field": "loc_count", "title": "Num loci in top n%"}, {"type": "quantitative", "field": "loc_count_filt", "title": "Num loci in top n% after operon filtering"}, {"type": "quantitative", "field": "min_exp", "title": "Min. ave. expr. in top n%"}], "x": {"type": "quantitative", "axis": {"grid": false, "title": "Number of loci in top n%"}, "field": "loc_count"}, "y": {"type": "quantitative", "axis": {"grid": false, "title": "Min. mean TPM of loci in top n%"}, "field": "min_exp"}}, "selection": {"selector002": {"type": "interval", "bind": "scales", "encodings": ["x", "y"]}}}, {"mark": {"type": "point", "size": 100}, "encoding": {"color": {"type": "ordinal", "field": "n", "legend": null, "scale": {"scheme": "viridis"}}, "tooltip": [{"type": "quantitative", "field": "n", "title": "Top N%"}, {"type": "quantitative", "field": "loc_count", "title": "Num loci in top n%"}, {"type": "quantitative", "field": "loc_count_filt", "title": "Num loci in top n% after operon filtering"}, {"type": "quantitative", "field": "min_exp", "title": "Min. ave. expr. in top n%"}], "x": {"type": "quantitative", "field": "loc_count_filt"}, "y": {"type": "quantitative", "field": "min_exp"}}}, {"mark": "rule", "encoding": {"color": {"type": "ordinal", "field": "n", "legend": null, "scale": {"scheme": "viridis"}}, "x": {"type": "quantitative", "field": "loc_count_filt"}, "x2": {"field": "loc_count"}, "y": {"type": "quantitative", "field": "min_exp"}}}, {"mark": {"type": "text", "align": "left", "angle": 335, "baseline": "middle", "color": "black", "dx": 5, "dy": -7, "size": 14}, "encoding": {"text": {"type": "nominal", "field": "n"}, "x": {"type": "quantitative", "field": "loc_count"}, "y": {"type": "quantitative", "field": "min_exp"}}, "transform": [{"calculate": "\"Top \" + datum.n + \"%\"", "as": "n"}]}], "data": {"name": "data-29352f19b76db6673fedcc2ec0518b04"}, "title": "Tradeoff between count and expression of top n% threshold", "$schema": "https://vega.github.io/schema/vega-lite/v4.0.2.json", "datasets": {"data-29352f19b76db6673fedcc2ec0518b04": [{"n": 1, "loc_count": 14, "loc_count_filt": 8, "min_exp": 3022.573901254243}, {"n": 2, "loc_count": 26, "loc_count_filt": 17, "min_exp": 1653.4809308825345}, {"n": 3, "loc_count": 37, "loc_count_filt": 25, "min_exp": 1131.6483177945438}, {"n": 4, "loc_count": 56, "loc_count_filt": 35, "min_exp": 930.2236840236529}, {"n": 5, "loc_count": 84, "loc_count_filt": 43, "min_exp": 667.4937748488659}, {"n": 6, "loc_count": 107, "loc_count_filt": 55, "min_exp": 469.3001818315513}, {"n": 7, "loc_count": 127, "loc_count_filt": 65, "min_exp": 369.78844153640347}, {"n": 8, "loc_count": 153, "loc_count_filt": 78, "min_exp": 313.0012225467378}, {"n": 9, "loc_count": 178, "loc_count_filt": 92, "min_exp": 313.0012225467378}, {"n": 10, "loc_count": 197, "loc_count_filt": 103, "min_exp": 259.9996722329314}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div class="error" style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
  <div style="font-family:Arial">
    
      <h2>Interactive plot instructions:</h2>
      <ul>
        <li>Hover over filled circles for more details</li>
        <li>Use mouse to click/scroll for panning and zooming</li>
      </ul>
    

    <div style="width:600px">
      <h2>Figure description</h2>
      <p>Tradeoff between gene count and TPM expression for different top gene sets depending on the n% threshold. Each point denotes a top gene set and shows the total count of all genes in the set on the x-axis versus the minimum geneâ€™s mean TPM value on the y-axis. For small values of n, the mean TPM expression of the weakest gene in the top set increases, while the total count of genes in the top set decreases, and vice versa. Filled circles represent all genes that qualify as the top n% across all conditions. Open circles represent filtered versions of the same set, where any gene predicted to be inside an operon (any except the first gene) has been excluded.</p>
    </div>

  </div>
</body>
</html>