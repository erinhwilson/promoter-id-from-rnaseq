<!DOCTYPE html>
<html>
<head>
  <style>
    .error {
        color: red;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-lite@4.0.2"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "area", "color": "gray", "opacity": 0.2, "orient": "vertical"}, "encoding": {"x": {"type": "quantitative", "field": "upstream_dist"}, "y": {"type": "quantitative", "axis": {"grid": false, "labels": false, "ticks": true, "values": [0]}, "field": "density", "impute": null, "scale": {"nice": false, "zero": false}, "stack": "center", "title": null}}, "height": 300, "transform": [{"density": "upstream_dist", "as": ["upstream_dist", "density"]}], "width": 500}, {"mark": "point", "encoding": {"color": {"type": "nominal", "field": "operon", "scale": {"scheme": "sinebow"}}, "opacity": {"condition": {"value": 1, "selection": "selector076"}, "value": 0.2}, "size": {"condition": {"value": 100, "selection": "selector076"}, "value": 10}, "tooltip": [{"type": "nominal", "field": "operon"}, {"type": "nominal", "field": "gene"}, {"type": "quantitative", "field": "upstream_dist"}], "x": {"type": "quantitative", "axis": {"title": "Upstream Distance"}, "field": "upstream_dist"}, "y": {"type": "quantitative", "axis": {"grid": false, "labels": false, "ticks": true, "values": [0]}, "field": "jitter", "scale": {}, "title": null}}, "height": 300, "selection": {"selector076": {"type": "multi", "fields": ["operon"], "bind": "legend"}, "selector077": {"type": "interval", "bind": "scales", "encodings": ["x", "y"]}}, "title": "Every non-starting operon gene's upstream distance", "transform": [{"calculate": "0.001*sqrt(-10*log(random()))*cos(10*PI*random())+0.007", "as": "jitter"}], "width": 500}], "data": {"name": "data-87f11a144365f109ef54836178a5d0ed"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.0.2.json", "datasets": {"data-87f11a144365f109ef54836178a5d0ed": [{"gene": "EQU24_RS06105", "upstream_dist": 64, "start?": false, "operon": "central_metab_edd"}, {"gene": "EQU24_RS06100", "upstream_dist": 238, "start?": false, "operon": "central_metab_edd"}, {"gene": "EQU24_RS06090", "upstream_dist": 16, "start?": false, "operon": "central_metab2"}, {"gene": "EQU24_RS06085", "upstream_dist": 100, "start?": false, "operon": "central_metab2"}, {"gene": "EQU24_RS06070", "upstream_dist": 134, "start?": false, "operon": "central_metab3"}, {"gene": "EQU24_RS06065", "upstream_dist": -1, "start?": false, "operon": "central_metab3"}, {"gene": "EQU24_RS05910", "upstream_dist": 23, "start?": false, "operon": "sMMO"}, {"gene": "EQU24_RS05905", "upstream_dist": 326, "start?": false, "operon": "sMMO"}, {"gene": "EQU24_RS05900", "upstream_dist": 9, "start?": false, "operon": "sMMO"}, {"gene": "EQU24_RS05895", "upstream_dist": 10, "start?": false, "operon": "sMMO"}, {"gene": "EQU24_RS05890", "upstream_dist": 113, "start?": false, "operon": "sMMO"}, {"gene": "EQU24_RS04945", "upstream_dist": 27, "start?": false, "operon": "flagellar_sys"}, {"gene": "EQU24_RS04940", "upstream_dist": 217, "start?": false, "operon": "flagellar_sys"}, {"gene": "EQU24_RS04935", "upstream_dist": -4, "start?": false, "operon": "flagellar_sys"}, {"gene": "EQU24_RS04930", "upstream_dist": -14, "start?": false, "operon": "flagellar_sys"}, {"gene": "EQU24_RS04925", "upstream_dist": -8, "start?": false, "operon": "flagellar_sys"}, {"gene": "EQU24_RS04920", "upstream_dist": 17, "start?": false, "operon": "flagellar_sys"}, {"gene": "EQU24_RS04915", "upstream_dist": 57, "start?": false, "operon": "flagellar_sys"}, {"gene": "EQU24_RS04910", "upstream_dist": -14, "start?": false, "operon": "flagellar_sys"}, {"gene": "EQU24_RS04905", "upstream_dist": 120, "start?": false, "operon": "flagellar_sys"}, {"gene": "EQU24_RS04565", "upstream_dist": 24, "start?": false, "operon": "serine_cycle"}, {"gene": "EQU24_RS04560", "upstream_dist": 125, "start?": false, "operon": "serine_cycle"}, {"gene": "EQU24_RS04555", "upstream_dist": 31, "start?": false, "operon": "serine_cycle"}, {"gene": "EQU24_RS02965", "upstream_dist": 200, "start?": false, "operon": "PQQ_synth"}, {"gene": "EQU24_RS02960", "upstream_dist": 22, "start?": false, "operon": "PQQ_synth"}, {"gene": "EQU24_RS02955", "upstream_dist": 31, "start?": false, "operon": "PQQ_synth"}, {"gene": "EQU24_RS02950", "upstream_dist": 85, "start?": false, "operon": "PQQ_synth"}, {"gene": "EQU24_RS02945", "upstream_dist": -23, "start?": false, "operon": "PQQ_synth"}, {"gene": "EQU24_RS02265", "upstream_dist": 21, "start?": false, "operon": "ATP_synthase"}, {"gene": "EQU24_RS02260", "upstream_dist": 45, "start?": false, "operon": "ATP_synthase"}, {"gene": "EQU24_RS02255", "upstream_dist": 12, "start?": false, "operon": "ATP_synthase"}, {"gene": "EQU24_RS02250", "upstream_dist": 16, "start?": false, "operon": "ATP_synthase"}, {"gene": "EQU24_RS02245", "upstream_dist": 5, "start?": false, "operon": "ATP_synthase"}, {"gene": "EQU24_RS02240", "upstream_dist": 42, "start?": false, "operon": "ATP_synthase"}, {"gene": "EQU24_RS02235", "upstream_dist": 42, "start?": false, "operon": "ATP_synthase"}, {"gene": "EQU24_RS02230", "upstream_dist": 24, "start?": false, "operon": "ATP_synthase"}, {"gene": "EQU24_RS01470", "upstream_dist": -4, "start?": false, "operon": "molyb_form_dh"}, {"gene": "EQU24_RS01465", "upstream_dist": 19, "start?": false, "operon": "molyb_form_dh"}, {"gene": "EQU24_RS01460", "upstream_dist": -8, "start?": false, "operon": "molyb_form_dh"}, {"gene": "EQU24_RS01455", "upstream_dist": 187, "start?": false, "operon": "molyb_form_dh"}, {"gene": "EQU24_RS21560", "upstream_dist": 129, "start?": false, "operon": "RuMP_cycle1"}, {"gene": "EQU24_RS21555", "upstream_dist": 126, "start?": false, "operon": "RuMP_cycle1"}, {"gene": "EQU24_RS21550", "upstream_dist": 201, "start?": false, "operon": "RuMP_cycle1"}, {"gene": "EQU24_RS19965", "upstream_dist": 22, "start?": false, "operon": "Rnf_elec_transp"}, {"gene": "EQU24_RS19960", "upstream_dist": 226, "start?": false, "operon": "Rnf_elec_transp"}, {"gene": "EQU24_RS19955", "upstream_dist": -4, "start?": false, "operon": "Rnf_elec_transp"}, {"gene": "EQU24_RS19950", "upstream_dist": 218, "start?": false, "operon": "Rnf_elec_transp"}, {"gene": "EQU24_RS19945", "upstream_dist": 11, "start?": false, "operon": "Rnf_elec_transp"}, {"gene": "EQU24_RS19940", "upstream_dist": -8, "start?": false, "operon": "Rnf_elec_transp"}, {"gene": "EQU24_RS19935", "upstream_dist": 4, "start?": false, "operon": "Rnf_elec_transp"}, {"gene": "EQU24_RS14895", "upstream_dist": 4, "start?": false, "operon": "urease"}, {"gene": "EQU24_RS14890", "upstream_dist": 28, "start?": false, "operon": "urease"}, {"gene": "EQU24_RS14885", "upstream_dist": 8, "start?": false, "operon": "urease"}, {"gene": "EQU24_RS14880", "upstream_dist": -8, "start?": false, "operon": "urease"}, {"gene": "EQU24_RS14875", "upstream_dist": 4, "start?": false, "operon": "urease"}, {"gene": "EQU24_RS14870", "upstream_dist": -11, "start?": false, "operon": "urease"}, {"gene": "EQU24_RS14865", "upstream_dist": 106, "start?": false, "operon": "urease"}, {"gene": "EQU24_RS14450", "upstream_dist": -1, "start?": false, "operon": "cyt_c_synth"}, {"gene": "EQU24_RS14445", "upstream_dist": 124, "start?": false, "operon": "cyt_c_synth"}, {"gene": "EQU24_RS14440", "upstream_dist": -4, "start?": false, "operon": "cyt_c_synth"}, {"gene": "EQU24_RS14435", "upstream_dist": -4, "start?": false, "operon": "cyt_c_synth"}, {"gene": "EQU24_RS14430", "upstream_dist": -4, "start?": false, "operon": "cyt_c_synth"}, {"gene": "EQU24_RS14425", "upstream_dist": -8, "start?": false, "operon": "cyt_c_synth"}, {"gene": "EQU24_RS14420", "upstream_dist": 22, "start?": false, "operon": "cyt_c_synth"}, {"gene": "EQU24_RS14415", "upstream_dist": 111, "start?": false, "operon": "cyt_c_synth"}, {"gene": "EQU24_RS14410", "upstream_dist": -4, "start?": false, "operon": "cyt_c_synth"}, {"gene": "EQU24_RS14405", "upstream_dist": -4, "start?": false, "operon": "cyt_c_synth"}, {"gene": "EQU24_RS14125", "upstream_dist": 52, "start?": false, "operon": "cyt_c_oxi"}, {"gene": "EQU24_RS19310", "upstream_dist": 108, "start?": false, "operon": "pMMO"}, {"gene": "EQU24_RS19305", "upstream_dist": 93, "start?": false, "operon": "pMMO"}, {"gene": "EQU24_RS18135", "upstream_dist": 65, "start?": false, "operon": "mxa_methanol_dh"}, {"gene": "EQU24_RS18130", "upstream_dist": 16, "start?": false, "operon": "mxa_methanol_dh"}, {"gene": "EQU24_RS18125", "upstream_dist": 17, "start?": false, "operon": "mxa_methanol_dh"}, {"gene": "EQU24_RS18120", "upstream_dist": 195, "start?": false, "operon": "mxa_methanol_dh"}, {"gene": "EQU24_RS17260", "upstream_dist": 19, "start?": false, "operon": "nif_elec_transp"}, {"gene": "EQU24_RS17255", "upstream_dist": -4, "start?": false, "operon": "nif_elec_transp"}, {"gene": "EQU24_RS17225", "upstream_dist": 61, "start?": false, "operon": "nif_cofactor1"}, {"gene": "EQU24_RS17220", "upstream_dist": 65, "start?": false, "operon": "nif_cofactor1"}, {"gene": "EQU24_RS17215", "upstream_dist": -4, "start?": false, "operon": "nif_cofactor1"}, {"gene": "EQU24_RS17210", "upstream_dist": 128, "start?": false, "operon": "nif_cofactor1"}, {"gene": "EQU24_RS17205", "upstream_dist": 19, "start?": false, "operon": "nif_cofactor1"}, {"gene": "EQU24_RS17200", "upstream_dist": -1, "start?": false, "operon": "nif_cofactor1"}, {"gene": "EQU24_RS17165", "upstream_dist": 5, "start?": false, "operon": "nif_cofactor2"}, {"gene": "EQU24_RS17160", "upstream_dist": 56, "start?": false, "operon": "nif_cofactor2"}, {"gene": "EQU24_RS17155", "upstream_dist": 99, "start?": false, "operon": "nif_cofactor2"}, {"gene": "EQU24_RS17150", "upstream_dist": 10, "start?": false, "operon": "nif_cofactor2"}, {"gene": "EQU24_RS17145", "upstream_dist": 8, "start?": false, "operon": "nif_cofactor2"}, {"gene": "EQU24_RS17140", "upstream_dist": 144, "start?": false, "operon": "nif_cofactor2"}, {"gene": "EQU24_RS17135", "upstream_dist": -4, "start?": false, "operon": "nif_cofactor2"}, {"gene": "EQU24_RS17130", "upstream_dist": 1, "start?": false, "operon": "nif_cofactor2"}, {"gene": "EQU24_RS17095", "upstream_dist": 9, "start?": false, "operon": "nif_structural"}, {"gene": "EQU24_RS17090", "upstream_dist": 3, "start?": false, "operon": "nif_structural"}, {"gene": "EQU24_RS17085", "upstream_dist": 10, "start?": false, "operon": "nif_structural"}, {"gene": "EQU24_RS17080", "upstream_dist": 72, "start?": false, "operon": "nif_structural"}, {"gene": "EQU24_RS17075", "upstream_dist": 142, "start?": false, "operon": "nif_structural"}, {"gene": "EQU24_RS17070", "upstream_dist": 137, "start?": false, "operon": "nif_structural"}, {"gene": "EQU24_RS16840", "upstream_dist": 2, "start?": false, "operon": "flagellum"}, {"gene": "EQU24_RS16835", "upstream_dist": 24, "start?": false, "operon": "flagellum"}, {"gene": "EQU24_RS16830", "upstream_dist": 24, "start?": false, "operon": "flagellum"}, {"gene": "EQU24_RS16825", "upstream_dist": 20, "start?": false, "operon": "flagellum"}, {"gene": "EQU24_RS16820", "upstream_dist": 63, "start?": false, "operon": "flagellum"}, {"gene": "EQU24_RS16815", "upstream_dist": 9, "start?": false, "operon": "flagellum"}, {"gene": "EQU24_RS16810", "upstream_dist": 31, "start?": false, "operon": "flagellum"}, {"gene": "EQU24_RS16805", "upstream_dist": 12, "start?": false, "operon": "flagellum"}, {"gene": "EQU24_RS16800", "upstream_dist": 27, "start?": false, "operon": "flagellum"}, {"gene": "EQU24_RS16795", "upstream_dist": 13, "start?": false, "operon": "flagellum"}, {"gene": "EQU24_RS15380", "upstream_dist": 16, "start?": false, "operon": "hopanoid_synth"}, {"gene": "EQU24_RS15375", "upstream_dist": 19, "start?": false, "operon": "hopanoid_synth"}, {"gene": "EQU24_RS15370", "upstream_dist": -4, "start?": false, "operon": "hopanoid_synth"}, {"gene": "EQU24_RS15365", "upstream_dist": 10, "start?": false, "operon": "hopanoid_synth"}, {"gene": "EQU24_RS12060", "upstream_dist": -8, "start?": false, "operon": "b12_synth"}, {"gene": "EQU24_RS12055", "upstream_dist": -4, "start?": false, "operon": "b12_synth"}, {"gene": "EQU24_RS12050", "upstream_dist": -4, "start?": false, "operon": "b12_synth"}, {"gene": "EQU24_RS12045", "upstream_dist": -8, "start?": false, "operon": "b12_synth"}, {"gene": "EQU24_RS12040", "upstream_dist": -11, "start?": false, "operon": "b12_synth"}, {"gene": "EQU24_RS12035", "upstream_dist": 5, "start?": false, "operon": "b12_synth"}, {"gene": "EQU24_RS12030", "upstream_dist": 10, "start?": false, "operon": "b12_synth"}, {"gene": "EQU24_RS12025", "upstream_dist": 9, "start?": false, "operon": "b12_synth"}, {"gene": "EQU24_RS12020", "upstream_dist": 9, "start?": false, "operon": "b12_synth"}, {"gene": "EQU24_RS12015", "upstream_dist": -4, "start?": false, "operon": "b12_synth"}, {"gene": "EQU24_RS12010", "upstream_dist": 38, "start?": false, "operon": "b12_synth"}, {"gene": "EQU24_RS12005", "upstream_dist": 2, "start?": false, "operon": "b12_synth"}, {"gene": "EQU24_RS11550", "upstream_dist": 68, "start?": false, "operon": "heat_shock"}, {"gene": "EQU24_RS11545", "upstream_dist": 70, "start?": false, "operon": "heat_shock"}, {"gene": "EQU24_RS11540", "upstream_dist": 155, "start?": false, "operon": "heat_shock"}, {"gene": "EQU24_RS11535", "upstream_dist": 5, "start?": false, "operon": "heat_shock"}, {"gene": "EQU24_RS11520", "upstream_dist": 3, "start?": false, "operon": "w_formate_dh"}, {"gene": "EQU24_RS10245", "upstream_dist": 1, "start?": false, "operon": "FeS_cofactor"}, {"gene": "EQU24_RS10240", "upstream_dist": 64, "start?": false, "operon": "FeS_cofactor"}, {"gene": "EQU24_RS10235", "upstream_dist": 14, "start?": false, "operon": "FeS_cofactor"}, {"gene": "EQU24_RS09785", "upstream_dist": 12, "start?": false, "operon": "NADH_dh"}, {"gene": "EQU24_RS09780", "upstream_dist": -1, "start?": false, "operon": "NADH_dh"}, {"gene": "EQU24_RS09775", "upstream_dist": 10, "start?": false, "operon": "NADH_dh"}, {"gene": "EQU24_RS09770", "upstream_dist": -8, "start?": false, "operon": "NADH_dh"}, {"gene": "EQU24_RS09765", "upstream_dist": -1, "start?": false, "operon": "NADH_dh"}, {"gene": "EQU24_RS08685", "upstream_dist": 1, "start?": false, "operon": "hydrogenase"}, {"gene": "EQU24_RS08680", "upstream_dist": -8, "start?": false, "operon": "hydrogenase"}, {"gene": "EQU24_RS08675", "upstream_dist": 354, "start?": false, "operon": "hydrogenase"}, {"gene": "EQU24_RS08670", "upstream_dist": -35, "start?": false, "operon": "hydrogenase"}, {"gene": "EQU24_RS08665", "upstream_dist": 264, "start?": false, "operon": "hydrogenase"}, {"gene": "EQU24_RS08395", "upstream_dist": 9, "start?": false, "operon": "transhydrogenase"}, {"gene": "EQU24_RS06980", "upstream_dist": -1, "start?": false, "operon": "succ_dh"}, {"gene": "EQU24_RS06975", "upstream_dist": 2, "start?": false, "operon": "succ_dh"}, {"gene": "EQU24_RS06970", "upstream_dist": 9, "start?": false, "operon": "succ_dh"}, {"gene": "EQU24_RS06965", "upstream_dist": 60, "start?": false, "operon": "succ_dh"}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div class="error" style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
  <div style="font-family:Arial">
    
      <h2>Interactive plot instructions:</h2>
      <ul>
        <li>Hover over points and lines for more information about each gene</li>
        <li>Click operons in the legend to highlight genes in the plot</li>
        <li>Hold SHIFT and Click operons in the legend to select multiple (Click anywhere in legend to clear selection)</li>
        <li>Click+drag mouse to pan</li>
        <li>Use scroll wheel to zoom</li>
      </ul>
    

    <div style="width:600px">
      <h2>Figure description</h2>
      <p>Distribution of upstream distances for non-leading genes in an operon (all genes except the first gene) for known operons in <i>M. buryatense</i>. Each point is a gene, colored by its operon membership. The x-axis is the distance in base pairs to its upstream  neighbor. The y-axis is jittered to spread out the points. A violin plot underlay shows the distribution of genes' intra-operon distances. </p>
    </div>

  </div>
</body>
</html>